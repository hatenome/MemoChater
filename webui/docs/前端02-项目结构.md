# MemoChater WebUI - 项目结构

## 目录结构

```
webui/
├── src/
│   ├── main.ts                 # 入口文件：创建Vue应用、注册插件
│   ├── App.vue                 # 根组件：布局框架
│   ├── router.ts               # 路由配置
│   ├── style.css               # 全局样式（TailwindCSS）
│   ├── vite-env.d.ts           # Vite 类型声明
│   │
│   ├── api/                    # 【API 客户端层】
│   │   ├── index.ts            # 统一导出
│   │   │                       # - modelsApi: 动态模型列表
│   │   │                       # - processorsApi: 动态处理器列表 ⭐
│   │   ├── client.ts           # 基础请求封装
│   │   │                       # - request<T>(): 通用请求函数
│   │   │                       # - api.get/post/put/delete
│   │   ├── assistants.ts       # 助手管理 API
│   │   │                       # - list / get / create / update / delete
│   │   │                       # - listTopics / createTopic / deleteTopic
│   │   │                       # - getHistory / clearHistory
│   │   │                       # - updateMessage / deleteMessage / createBranch
│   │   ├── memory.ts           # 记忆管理 API
│   │   │                       # - search / get / create / delete
│   │   │                       # - getPending / processPending / clearPending
│   │   │                       # - extract
│   │   └── chat.ts             # 对话 API
│   │                           # - complete(): 非流式对话
│   │                           # - stream(): 流式对话生成器
│   │
│   ├── stores/                 # 【Pinia 状态管理】
│   │   ├── index.ts            # 统一导出
│   │   ├── app.ts              # 应用全局状态
│   │   │                       # - toasts: 消息提示队列
│   │   │                       # - sidebarCollapsed: 侧边栏折叠状态
│   │   │                       # - showToast(): 显示提示
│   │   └── assistant.ts        # 助手相关状态
│   │                           # - assistants: 助手列表
│   │                           # - currentAssistantId/Config
│   │                           # - topics: 话题列表
│   │                           # - currentTopicId
│   │                           # - messages: 当前对话消息
│   │                           # - editMessage / removeMessage / createBranchFromMessage
│   │
│   ├── types/                  # 【TypeScript 类型定义】
│   │   └── index.ts            # 所有类型定义
│   │                           # - AssistantConfig / AssistantSummary
│   │                           # - ModelConfig (含四种模型配置)
│   │                           # - PipelineConfig / ProcessorEntry ⭐
│   │                           # - TopicMeta / TopicSummary / TopicType
│   │                           # - ChatMessage
│   │                           # - Memory / MemorySearchResult
│   │                           # - PendingMemory / PendingStatus
│   │                           # - ModelInfo / ProcessorInfo ⭐
│   │                           # - ConversationTurn ⭐ 新增
│   │                           # - ApiResponse<T>
│   │
│   ├── components/             # 【通用组件】
│   │   ├── Sidebar.vue         # 侧边栏
│   │   │                       # - 助手列表
│   │   │                       # - 话题列表（分组：普通/记忆）
│   │   │                       # - 底部导航
│   │   ├── Toast.vue           # 消息提示组件
│   │   ├── ChatInput.vue       # 聊天输入框
│   │   │                       # - 支持 Enter 发送
│   │   │                       # - 支持 Shift+Enter 换行
│   │   └── ChatMessage.vue     # 消息气泡组件
│   │                           # - 用户/助手样式区分
│   │                           # - 角色名显示
│   │                           # - 悬停显示操作按钮
│   │                           # - 编辑/删除/分支功能
│   │
│   └── views/                  # 【页面视图】
│       ├── ChatView.vue        # 对话页面
│       │                       # - 消息列表展示
│       │                       # - 流式响应处理
│       │                       # - 自动滚动
│       │                       # - 消息操作事件处理
│       │                       # - 记忆话题显示记忆面板
│       ├── AssistantsView.vue  # 助手管理页面
│       │                       # - 助手列表
│       │                       # - 创建/编辑模态框
│       │                       # - 完整模型配置（四种模型）
│       │                       # - 动态模型列表
│       │                       # - 流水线配置模态框 ⭐
│       │                       # - 动态处理器列表 ⭐
│       ├── MemoryView.vue      # 记忆管理页面
│       │                       # - 记忆搜索
│       │                       # - 创建记忆
│       │                       # - 待处理池管理
│       └── SettingsView.vue    # 设置页面
│                               # - API 地址配置
│                               # - 主题设置
│
├── public/                     # 【静态资源】
│   └── favicon.svg             # 网站图标
│
├── docs/                       # 【项目文档】
│   ├── 前端01-总体框架.md
│   ├── 前端02-项目结构.md
│   ├── 前端03-组件说明.md
│   └── 前端04-开发指南.md
│
├── index.html                  # HTML 模板
├── package.json                # 依赖配置
├── vite.config.ts              # Vite 配置
├── tailwind.config.js          # TailwindCSS 配置
├── postcss.config.js           # PostCSS 配置
├── tsconfig.json               # TypeScript 配置
└── tsconfig.node.json          # Node 环境 TS 配置
```

## 模块职责说明

### API 层 (`src/api/`)

| 文件 | 职责 |
|------|------|
| `client.ts` | 基础请求封装，统一错误处理 |
| `index.ts` | 统一导出 + modelsApi + processorsApi ⭐ |
| `assistants.ts` | 助手/话题/历史/消息操作 CRUD |
| `memory.ts` | 记忆搜索/创建/待处理池 |
| `chat.ts` | 对话接口（流式/非流式） |

### 状态管理 (`src/stores/`)

| Store | 职责 |
|-------|------|
| `app` | 全局UI状态（Toast、侧边栏） |
| `assistant` | 助手/话题/消息数据管理，含消息操作方法 |

### 组件 (`src/components/`)

| 组件 | 职责 |
|------|------|
| `Sidebar` | 导航侧边栏（话题分组显示） |
| `Toast` | 消息提示 |
| `ChatInput` | 聊天输入 |
| `ChatMessage` | 消息展示（含编辑/删除/分支按钮）|

### 视图 (`src/views/`)

| 视图 | 路由 | 职责 |
|------|------|------|
| `ChatView` | `/chat/*` | 对话主界面，消息操作，记忆面板 |
| `AssistantsView` | `/assistants` | 助手管理，流水线配置 ⭐ |
| `MemoryView` | `/memory/:assistantId` | 记忆管理（按助手隔离） |
| `SettingsView` | `/settings` | 设置 |

## API 接口说明

### 动态数据获取

| API | 端点 | 用途 |
|-----|------|------|
| modelsApi.list() | `/admin/api/models` | 获取可用模型列表 |
| processorsApi.list() | `/admin/api/processors` | 获取已注册处理器列表 ⭐ |

### ProcessorInfo 结构

```typescript
interface ProcessorInfo {
  name: string           // 处理器名称
  requires_memory: boolean  // 是否需要记忆功能
}
```